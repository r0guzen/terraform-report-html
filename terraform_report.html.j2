<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Terraform Change Report – {{ device_name }}</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f7fa;
  padding: 24px;
}

h2 { margin-top: 0; }

.group {
  background: white;
  border-radius: 10px;
  margin-bottom: 16px;
  box-shadow: 0 2px 6px rgba(0,0,0,.05);
}

summary {
  padding: 14px;
  cursor: pointer;
  font-weight: 600;
}

.resource {
  border-top: 1px solid #eee;
  padding: 12px;
}

.create { border-left: 5px solid #2ecc71; }
.update { border-left: 5px solid #f1c40f; }
.delete { border-left: 5px solid #e74c3c; }

.cols {
  display: flex;
  gap: 16px;
}

.col { width: 50%; }

pre {
  background: #f7f7f7;
  padding: 8px;
  border-radius: 6px;
  font-size: 12px;
}
</style>
</head>

<body>

<h2>Device: {{ device_name }}</h2>

{% for type, items in resources | groupby("type") %}
<details class="group">
  <summary>{{ type }} ({{ items|length }})</summary>

  {% for r in items %}
  {% set action = r.actions[0] %}
  <div class="resource {{ action }}">
    <strong>{{ r.address }}</strong> — {{ action|upper }}

    <div class="cols">
      <div class="col">
        <h4>Before</h4>
        <pre>{{ r.before | to_nice_json }}</pre>
      </div>

      <div class="col">
        <h4>After</h4>
        <pre>{{ r.after | to_nice_json }}</pre>
      </div>
    </div>
  </div>
  {% endfor %}
</details>
{% endfor %}

<footer style="margin-top:30px;font-size:12px;color:#888">
Preview only. Final changes validated via FortiManager install preview.
</footer>

</body>
</html>
