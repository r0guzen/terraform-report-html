<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Terraform Change Report</title>

<style>
body { font-family: Arial, sans-serif; margin: 20px; }
.resource { border: 1px solid #ddd; padding: 12px; margin-bottom: 15px; border-radius: 6px; }
.create { border-left: 6px solid #2ecc71; }
.update { border-left: 6px solid #f1c40f; }
.delete { border-left: 6px solid #e74c3c; }

.header { font-weight: bold; margin-bottom: 6px; }
.cols { display: flex; gap: 20px; }
.col { width: 50%; }

pre { background: #f7f7f7; padding: 8px; border-radius: 4px; overflow-x: auto; }

details summary { cursor: pointer; font-weight: bold; }

.badge {
  padding: 2px 8px;
  border-radius: 4px;
  color: white;
  font-size: 12px;
}

.create-badge { background: #2ecc71; }
.update-badge { background: #f1c40f; }
.delete-badge { background: #e74c3c; }
</style>
</head>

<body>

<h2>Terraform Change Report</h2>

{% if terraform_changes | length == 0 %}
<p>No effective changes detected.</p>
{% endif %}

{% for r in terraform_changes %}
{% set action = r.actions[0] %}
<div class="resource {{ action }}">
  <div class="header">
    {{ r.address }}
    <span class="badge {{ action }}-badge">{{ action|upper }}</span>
  </div>

  <div class="cols">
    <div class="col">
      <details open>
        <summary>Before</summary>
        <pre>{{ r.before | to_nice_json }}</pre>
      </details>
    </div>

    <div class="col">
      <details open>
        <summary>After</summary>
        <pre>{{ r.after | to_nice_json }}</pre>
      </details>
    </div>
  </div>
</div>
{% endfor %}

</body>
</html>
